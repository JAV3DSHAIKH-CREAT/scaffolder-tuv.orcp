<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TUV PROFESSIONAL DATABASE</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

<style>
:root{
    --dark-bg:#0f172a;
    --card-bg:#1e293b;
    --accent:#2563eb;
    --light:#e2e8f0;
    --muted:#94a3b8;
    --shadow:0 10px 25px rgba(0,0,0,0.4);
}
*{margin:0;padding:0;box-sizing:border-box}

body{
    font-family:'Poppins',sans-serif;
    background:var(--dark-bg);
    color:var(--light);
    min-height:100vh;
}

header{
    background:linear-gradient(135deg,#1e3a8a,#2563eb);
    padding:20px;
    text-align:center;
    border-bottom-left-radius:30px;
    border-bottom-right-radius:30px;
    box-shadow:var(--shadow);
}

header h1{font-size:1.4rem;font-weight:600}
header p{font-size:.8rem;opacity:.8}

.search-wrapper{
    max-width:500px;
    margin:20px auto;
    position:relative;
}

#mainSearch{
    width:100%;
    padding:12px 20px;
    border-radius:50px;
    border:1px solid #334155;
    background:#1e293b;
    color:white;
    font-size:0.9rem;
}

.suggestions{
    position:absolute;
    top:50px;
    left:0;
    right:0;
    background:#1e293b;
    border-radius:15px;
    max-height:220px;
    overflow-y:auto;
    display:none;
    border:1px solid #334155;
    box-shadow:var(--shadow);
}

.suggestion-item{
    padding:10px 20px;
    cursor:pointer;
    border-bottom:1px solid #334155;
    font-size:.85rem;
}
.suggestion-item:hover{background:#2563eb}

.highlight{
    color:#facc15;
    font-weight:600;
}

.container{
    max-width:95%;
    margin:0 auto 50px auto;
    display:flex;
    flex-wrap:wrap;
    gap:15px;
    justify-content:center;
}

.section-box{
    background:var(--card-bg);
    width:48%;
    padding:15px;
    border-radius:15px;
    box-shadow:var(--shadow);
    border:1px solid #334155;
}

.section-box h3{
    margin-bottom:10px;
    font-weight:700;
    font-size:.95rem;
    color:#3b82f6;
    border-left:4px solid var(--accent);
    padding-left:8px;
}

.section-grid{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:8px;
}

.info-card{
    background:#0f172a;
    padding:8px 10px;
    border-radius:8px;
    border:1px solid #334155;
}

.label{
    font-size:.6rem;
    color:var(--muted);
    text-transform:uppercase;
}

.value{
    font-size:.85rem;
    font-weight:500;
    word-break:break-word;
}

.status-expired{color:#f87171;font-weight:600}
.status-warning{color:#facc15;font-weight:600}
.status-valid{color:#22c55e;font-weight:600}

footer{
    text-align:center;
    padding:10px;
    background:#1e293b;
    font-size:.75rem;
    color:var(--muted);
}

@media(max-width:1000px){
    .section-box{width:100%}
}
</style>
</head>

<body>

<header>
    <h1>TUV CERTIFICATE DATABASE</h1>
    <p>PROFESSIONAL RECORD MANAGEMENT SYSTEM</p>
</header>

<div class="search-wrapper">
    <input type="text" id="mainSearch" placeholder="Search by EMP# or NAME..." autocomplete="off">
    <div id="suggestions" class="suggestions"></div>
</div>

<div class="container" id="infoContainer"></div>

<footer>
Created and Managed by Mohammad Javed Shaikh
</footer>

<script>
const FILE_URL="for%20web%20TUV.xlsx";
let headers=[];
let rows=[];

async function loadExcel(){
    const response=await fetch(FILE_URL);
    const buffer=await response.arrayBuffer();
    const workbook=XLSX.read(buffer,{type:"array"});
    const sheet=workbook.Sheets["TUV"];
    const json=XLSX.utils.sheet_to_json(sheet,{header:1});
    headers=json[0];
    rows=json.slice(1);
}
loadExcel();

const searchInput=document.getElementById("mainSearch");
const suggestBox=document.getElementById("suggestions");

searchInput.addEventListener("input",function(){
    const query=this.value.toLowerCase().trim();
    suggestBox.innerHTML="";
    if(query.length<1){suggestBox.style.display="none";return;}

    const matches=rows.filter(row=>{
        const colA=String(row[0]||"").toLowerCase();
        const colB=String(row[1]||"").toLowerCase();
        return colA.includes(query)||colB.includes(query);
    }).slice(0,8);

    if(matches.length>0){
        suggestBox.style.display="block";
        matches.forEach(row=>{
            const div=document.createElement("div");
            div.className="suggestion-item";
            const text=row[0]+" - "+row[1];
            const regex=new RegExp(query,"gi");
            div.innerHTML=text.replace(regex,match=>`<span class="highlight">${match}</span>`);
            div.onclick=()=>renderDetails(row);
            suggestBox.appendChild(div);
        });
    }else{
        suggestBox.style.display="none";
    }
});

function renderDetails(row){
    suggestBox.style.display="none";
    const container=document.getElementById("infoContainer");
    container.innerHTML="";

    function createSection(title,start,end){
        let section=document.createElement("div");
        section.className="section-box";
        let html=`<h3>${title}</h3><div class="section-grid">`;

        for(let i=start;i<end;i++){
            let label=headers[i]||"";
            let value=row[i]||"N/A";

            if(label.toLowerCase().includes("expiry")){
                const date=new Date(value);
                const diff=Math.ceil((date-new Date())/(1000*60*60*24));
                if(diff<0)value=`${diff} (Expired)`;
                else if(diff<30)value=`${diff} Days`;
            }

            html+=`
            <div class="info-card">
                <span class="label">${label}</span>
                <span class="value">${value}</span>
            </div>`;
        }

        html+=`</div>`;
        section.innerHTML=html;
        container.appendChild(section);
    }

    createSection("Employee Info",0,5);
    createSection("Certificate Info",5,10);
    createSection("Additional Details",10,headers.length);
}

window.addEventListener("click",(e)=>{
    if(!e.target.closest(".search-wrapper")){
        suggestBox.style.display="none";
    }
});
</script>

</body>
</html>
